// Prisma schema pour remplacer le stockage JSON par SQLite
// Modèles: User, StepEntry, Meta (clé-valeur pour les métadonnées + drapeau de migration)

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  userId          String       @id
  dailyStepsGoal  Int?
  weeklyStepsGoal Int?
  entries         DailyEntry[]
}

model DailyEntry {
  userId String
  date   String
  steps  Int?
  user   User   @relation(fields: [userId], references: [userId], onDelete: Cascade)

  @@id([userId, date])
  @@index([date])
}

model Meta {
  key   String  @id
  value String?
}
